{% extends 'base.html' %}
{% load static %}

{% block title %}Cadastro de Feirantes | EXTENSÃƒO AmazÃ´nia{% endblock %}

{% block content %}
<section class="content-header">
  <div class="container-fluid">
    <h1><i class="fas fa-people-carry text-orange"></i> Cadastro de Feirantes</h1>
    <p class="text-muted">FormulÃ¡rio para registro de informaÃ§Ãµes sobre feiras comunitÃ¡rias e seus impactos.</p>
  </div>
</section>

<section class="content">
  <div class="container-fluid">
    <form method="post">
      {% csrf_token %}
      <div class="card card-outline card-warning shadow">
        <div class="card-header">
          <h3 class="card-title"><i class="fas fa-store-alt"></i> InformaÃ§Ãµes da Feira</h3>
        </div>
        <div class="card-body">

          <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-orange"><i class="fas fa-info-circle"></i> IdentificaÃ§Ã£o</legend>

            <div class="form-row">
              <div class="form-group col-md-6">
                <label>ğŸ›ï¸ Nome da Feira</label>
                <input type="text" name="nome_feira" class="form-control">
              </div>
              <div class="form-group col-md-6">
                <label>ğŸ“ Local</label>
                <input type="text" name="local" class="form-control">
              </div>
            </div>

            <div class="form-group">
  <label><strong>â° PerÃ­odo de RealizaÃ§Ã£o</strong></label>
  <div class="form-check">
    <input class="form-check-input" type="radio" name="periodicidade" id="periodo1" value="1 vez por semana">
    <label class="form-check-label" for="periodo1">1 vez por semana</label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="periodicidade" id="periodo3" value="1 vez por mÃªs">
    <label class="form-check-label" for="periodo3">1 vez por mÃªs</label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="periodicidade" id="periodo2" value="2 vezes por mÃªs">
    <label class="form-check-label" for="periodo2">2 vezes por mÃªs</label>
  </div>

  

</div>


          </fieldset>

          <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-success"><i class="fas fa-seedling"></i> ProduÃ§Ã£o e ComercializaÃ§Ã£o</legend>

            <div class="form-group">
              <label>ğŸ¥¬ Produtos vendidos</label>
              <textarea name="produtos" class="form-control"></textarea>
            </div>
            <div class="form-group">
              <label>ğŸ“¦ Volume comercializado</label>
              <input type="text" name="volume" class="form-control">
            </div>
            <div class="form-group">
              <label>ğŸ“ˆ Produtos mais vendidos</label>
              <textarea name="produtos_mais_vendidos" class="form-control"></textarea>
            </div>
          </fieldset>

          <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-primary"><i class="fas fa-hands-helping"></i> Impactos e ContribuiÃ§Ãµes</legend>

            <div class="form-group">
  <label><strong>ğŸ¯ Quais benefÃ­cios vocÃª percebe em participar das feiras?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="beneficios[]" id="beneficio1" value="GeraÃ§Ã£o de renda e sustento familiar">
    <label class="form-check-label" for="beneficio1">
      GeraÃ§Ã£o de renda e sustento familiar
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="beneficios[]" id="beneficio2" value="Contato direto com os clientes e divulgaÃ§Ã£o dos produtos">
    <label class="form-check-label" for="beneficio2">
      Contato direto com os clientes e divulgaÃ§Ã£o dos produtos
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="beneficios[]" id="beneficio3" value="Troca de experiÃªncias e fortalecimento da economia local">
    <label class="form-check-label" for="beneficio3">
      Troca de experiÃªncias e fortalecimento da economia local
    </label>
  </div>
</div>


            <div class="form-group">
  <label><strong>ğŸ¤ Como a feira contribui para a venda dos seus produtos?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="contribuicao[]" id="contribuicao1" value="Aumenta a visibilidade e facilita o contato direto com o consumidor">
    <label class="form-check-label" for="contribuicao1">
      Aumenta a visibilidade e facilita o contato direto com o consumidor
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="contribuicao[]" id="contribuicao2" value="Permite vender com maior frequÃªncia e em maior volume">
    <label class="form-check-label" for="contribuicao2">
      Permite vender com maior frequÃªncia e em maior volume
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="contribuicao[]" id="contribuicao3" value="Reduz custos com transporte e intermediaÃ§Ã£o">
    <label class="form-check-label" for="contribuicao3">
      Reduz custos com transporte e intermediaÃ§Ã£o
    </label>
  </div>
</div>


            <div class="form-group">
  <label><strong>ğŸ’ª A participaÃ§Ã£o nas feiras tem ajudado no fortalecimento da sua produÃ§Ã£o ou organizaÃ§Ã£o comunitÃ¡ria? De que forma?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="fortalecimento[]" id="fort1" value="Sim, fortaleceu a produÃ§Ã£o com aumento da demanda e incentivo ao cultivo contÃ­nuo">
    <label class="form-check-label" for="fort1">
      Sim, fortaleceu a produÃ§Ã£o com aumento da demanda e incentivo ao cultivo contÃ­nuo
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="fortalecimento[]" id="fort2" value="Sim, contribuiu para uniÃ£o com outros produtores e participaÃ§Ã£o em associaÃ§Ãµes ou grupos">
    <label class="form-check-label" for="fort2">
      Sim, contribuiu para uniÃ£o com outros produtores e participaÃ§Ã£o em associaÃ§Ãµes ou grupos
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="fortalecimento[]" id="fort3" value="NÃ£o houve mudanÃ§as significativas na produÃ§Ã£o ou organizaÃ§Ã£o comunitÃ¡ria atÃ© o momento">
    <label class="form-check-label" for="fort3">
      NÃ£o houve mudanÃ§as significativas na produÃ§Ã£o ou organizaÃ§Ã£o comunitÃ¡ria atÃ© o momento
    </label>
  </div>
  <br>

  <div class="form-group">
  <label><strong>ğŸ“¦ Produtos com maior aceitaÃ§Ã£o nas feiras</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="produtos_aceitacao[]" id="produto1" value="HortaliÃ§as e verduras">
    <label class="form-check-label" for="produto1">
      HortaliÃ§as e verduras (como alface, cheiro-verde, couve, etc.)
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="produtos_aceitacao[]" id="produto2" value="Frutas da Ã©poca">
    <label class="form-check-label" for="produto2">
      Frutas da Ã©poca (como banana, manga, melancia, etc.)
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="produtos_aceitacao[]" id="produto3" value="Produtos processados/artesanais">
    <label class="form-check-label" for="produto3">
      Produtos processados/artesanais (como farinha, doces, polpas, mel, etc.)
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" id="produtoOutro" value="Outro">
    <label class="form-check-label" for="produtoOutro">Outros</label>
  </div>

  <!-- Campo de texto que sÃ³ aparece quando "Outros" for marcado -->
  <div id="campoOutroProduto" class="mt-2" style="display: none;">
    <input type="text" class="form-control" name="produtos_aceitacao[]" placeholder="Descreva os outros produtos">
  </div>
</div>


<div class="form-group">
  <label><strong>ğŸ“ A localizaÃ§Ã£o ou estrutura da feira favorece suas vendas? Por quÃª?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="estrutura_feira" id="estrutura1" value="Sim, porque Ã© de fÃ¡cil acesso para os clientes e tem boa circulaÃ§Ã£o de pessoas">
    <label class="form-check-label" for="estrutura1">
      Sim, porque Ã© de fÃ¡cil acesso para os clientes e tem boa circulaÃ§Ã£o de pessoas
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="estrutura_feira" id="estrutura2" value="Parcialmente, pois a localizaÃ§Ã£o Ã© boa, mas a estrutura precisa de melhorias">
    <label class="form-check-label" for="estrutura2">
      Parcialmente, pois a localizaÃ§Ã£o Ã© boa, mas a estrutura precisa de melhorias (como cobertura, higiene, seguranÃ§a)
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="estrutura_feira" id="estrutura3" value="NÃ£o, porque o local Ã© de difÃ­cil acesso ou mal estruturado">
    <label class="form-check-label" for="estrutura3">
      NÃ£o, porque o local Ã© de difÃ­cil acesso ou mal estruturado, o que afasta os clientes
    </label>
  </div>
</div>




</div>


          </fieldset>

          <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-secondary"><i class="fas fa-tools"></i> Estrutura e OperaÃ§Ã£o</legend>

            <div class="form-group">
              <label>ğŸ—ï¸ Os equipamentos e a estrutura da feira (barracas, iluminaÃ§Ã£o, etc.) sÃ£o adequados? O que poderia melhorar?</label>
              <input type="text" name="estrutura_apropriada" class="form-control" placeholder="Ex: cobertura, bancas, Ã¡gua, energia etc.">
            </div>

            <div class="form-group">
  <label><strong>âš™ï¸ Quais sÃ£o as principais dificuldades que vocÃª encontra para participar das feiras?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="dificuldades[]" id="dif1" value="Falta de transporte adequado ou alto custo para deslocamento">
    <label class="form-check-label" for="dif1">
      Falta de transporte adequado ou alto custo para deslocamento
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="dificuldades[]" id="dif2" value="Falta de estrutura na feira (como barracas, cobertura, Ã¡gua, energia)">
    <label class="form-check-label" for="dif2">
      Falta de estrutura na feira (como barracas, cobertura, Ã¡gua, energia)
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" name="dificuldades[]" id="dif3" value="Baixo movimento de clientes ou concorrÃªncia desleal com atravessadores">
    <label class="form-check-label" for="dif3">
      Baixo movimento de clientes ou concorrÃªncia desleal com atravessadores
    </label>
  </div>
</div>


            <div class="form-group">
  <label><strong>ğŸ“¢ Como Ã© a comunicaÃ§Ã£o e organizaÃ§Ã£o com os responsÃ¡veis pela feira?</strong></label>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="comunicacao" id="comunicacao1" value="Boa â€“ hÃ¡ diÃ¡logo, avisos com antecedÃªncia e apoio na organizaÃ§Ã£o">
    <label class="form-check-label" for="comunicacao1">
      Boa â€“ hÃ¡ diÃ¡logo, avisos com antecedÃªncia e apoio na organizaÃ§Ã£o
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="comunicacao" id="comunicacao2" value="Regular â€“ Ã s vezes hÃ¡ informaÃ§Ãµes, mas falta mais clareza e planejamento">
    <label class="form-check-label" for="comunicacao2">
      Regular â€“ Ã s vezes hÃ¡ informaÃ§Ãµes, mas falta mais clareza e planejamento
    </label>
  </div>

  <div class="form-check">
    <input class="form-check-input" type="radio" name="comunicacao" id="comunicacao3" value="Ruim â€“ falta comunicaÃ§Ã£o, organizaÃ§Ã£o e presenÃ§a dos responsÃ¡veis">
    <label class="form-check-label" for="comunicacao3">
      Ruim â€“ falta comunicaÃ§Ã£o, organizaÃ§Ã£o e presenÃ§a dos responsÃ¡veis
    </label>
  </div>
</div>


          </fieldset>

          <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-dark"><i class="fas fa-university"></i> Apoios e SugestÃµes</legend>

            <div class="form-group">
              <label>ğŸ›ï¸ VocÃª sente que hÃ¡ apoio suficiente por parte das instituiÃ§Ãµes locais ou da organizaÃ§Ã£o da feira?</label>
              <textarea name="apoio_institucional" class="form-control"></textarea>
            </div>
            <div class="form-group">
              <label>â— JÃ¡ enfrentou problemas com a aceitaÃ§Ã£o dos seus produtos ou com o pÃºblico consumidor?</label>
              <textarea name="problemas_aceitacao" class="form-control"></textarea>
            </div>
            <div class="form-group">
              <label>ğŸ’¬ O que vocÃª sugeriria para melhorar sua experiÃªncia e os resultados da participaÃ§Ã£o nas feiras?</label>
              <textarea name="sugestoes" class="form-control" placeholder="RecomendaÃ§Ãµes para melhorias, aÃ§Ãµes e eventos"></textarea>
            </div>
          </fieldset>


          <fieldset class="border p-3 mb-4">
  <legend class="w-auto text-info"><i class="fas fa-camera"></i> Foto de EvidÃªncia</legend>

  <div class="form-group text-center">
    <video id="video" width="100%" height="240" autoplay class="border rounded mb-2"></video>
    <canvas id="canvas" style="display:none;"></canvas>
    <input type="hidden" name="foto_base64" id="foto_base64">
    <button type="button" class="btn btn-outline-info" onclick="capturarFoto()">
      <i class="fas fa-camera"></i> Tirar Foto
    </button>
  </div>

  <div id="preview" class="text-center mt-3" style="display:none;">
    <p class="text-success"><i class="fas fa-check-circle"></i> Foto capturada com sucesso!</p>
    <img id="foto_preview" src="#" alt="PrÃ©via da Foto" class="img-thumbnail" style="max-width: 100%;">
  </div>
</fieldset>





        </div>
        <div class="card-footer d-flex justify-content-end">
          <button type="submit" class="btn btn-success">
            <i class="fas fa-save"></i> Salvar Cadastro
          </button>
        </div>
      </div>
    </form>
  </div>
</section>




<script>
  const outroCheckbox = document.getElementById('produtoOutro');
  const campoOutro = document.getElementById('campoOutroProduto');

  outroCheckbox.addEventListener('change', function () {
    campoOutro.style.display = this.checked ? 'block' : 'none';
    const input = campoOutro.querySelector('input');
    if (!this.checked) input.value = '';  // limpa se desmarcado
  });
</script>


<script>
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      document.getElementById('video').srcObject = stream;
    })
    .catch(error => {
      console.error("Erro ao acessar cÃ¢mera:", error);
      alert("NÃ£o foi possÃ­vel acessar a cÃ¢mera.");
    });

  function capturarFoto() {
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const preview = document.getElementById('preview');
    const fotoInput = document.getElementById('foto_base64');

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    const base64 = canvas.toDataURL('image/jpeg');
    fotoInput.value = base64;

    document.getElementById('foto_preview').src = base64;
    preview.style.display = 'block';
  }
</script>


{% endblock %}
